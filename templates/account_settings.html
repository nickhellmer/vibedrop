{% extends "base.html" %}
{% block title %}Account Settings - VibeDrop{% endblock %}

{% block content %}
<style>
  h1 {
    font-size: 2.4rem;
    font-weight: 600;
    color: #7B4EFF;
    margin-bottom: 30px;
  }

  label {
    display: block;
    margin: 20px 0 8px;
    font-weight: 600;
  }

  input[type="text"],
  input[type="email"],
  input[type="password"] {
    width: 100%;
    padding: 10px;
    font-size: 1rem;
    background-color: #1E1E1E;
    border: 1px solid #333;
    border-radius: 6px;
    color: #FFF;
  }

  input::placeholder {
    color: #777;
  }

  input[type="checkbox"] {
    transform: scale(1.3);
    margin-right: 10px;
  }

  button {
    background-color: #7B4EFF;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 6px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    margin-top: 25px;
    display: inline-block;
  }

  button:hover {
    background-color: #6a3fdc;
  }

  .form-section {
    margin-bottom: 50px;
  }

  .danger-zone {
    border-top: 1px solid #444;
    padding-top: 30px;
    margin-top: 50px;
  }

  .danger-zone h2 {
    color: #ff4d4d;
    font-weight: 600;
    font-size: 1.5rem;
  }

  .danger-btn {
    background-color: #ff4d4d;
  }

  .danger-btn:hover {
    background-color: #e63c3c;
  }

  ul {
    padding-left: 20px;
  }

  li {
    margin-bottom: 10px;
  }

  .circle-leave-form {
    display: inline;
  }

  .leave-button {
    background-color: transparent;
    border: 1px solid #ff4d4d;
    color: #ff4d4d;
    padding: 5px 10px;
    font-size: 0.9rem;
    border-radius: 4px;
    margin-left: 10px;
    cursor: pointer;
  }

  .leave-button:hover {
    background-color: #ff4d4d;
    color: white;
  }

  .readonly {
    background-color: #1e1e1e;
    color: #aaa;
    border: 1px solid #333;
  }
</style>

<h1>Account Settings</h1>

<div class="form-section">
  <form method="POST" action="/account-settings">
    <label for="new_username">Username</label>
    <input type="text" name="new_username" value="{{ user.vibedrop_username }}" required>

    <label>Spotify Display Name</label>
    <input type="text" value="{{ user.display_name or 'â€”' }}" readonly class="readonly">

    <label for="phone_number">Phone Number (for SMS reminders)</label>
    <input type="text" name="phone_number" placeholder="+1 (555) 123-4567" value="{{ user.phone_number or '' }}">
    
    <label>
      <input type="checkbox" name="sms_notifications" {% if user.sms_notifications %}checked{% endif %}>
      Enable SMS reminders
    </label>

    <button type="submit">Save Changes</button>
  </form>
</div>

<div class="form-section">
  <h2>My Sound Circles</h2>
  {% if user.circle_memberships %}
    <ul>
      {% for membership in user.circle_memberships %}
        <li>
          {{ membership.circle.circle_name }}
          <form method="POST" action="/leave_circle" class="circle-leave-form">
            <input type="hidden" name="circle_id" value="{{ membership.circle.id }}">
            <button class="leave-button" type="submit" onclick="return confirm('Leave {{ membership.circle.circle_name }}?')">Leave</button>
          </form>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>You are not currently in any Sound Circles.</p>
  {% endif %}
</div>

<div class="danger-zone">
  <h2>Danger Zone</h2>
  <form method="POST" action="/delete-account">
    <button class="danger-btn" onclick="return confirm('Are you sure you want to delete your account? This cannot be undone.')">
      Delete My Account
    </button>
  </form>
</div>
{% endblock %}